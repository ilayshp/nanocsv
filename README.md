# NanoCSV, Faster C++11 multithreaded header-only CSV parser

NanoCSV is a fater C++11 multithreaded header-only CSV parser.

## Compiler options

* NANOCSV_NO_IO : Disable I/O(file access, stdio, mmap).

## TODO

* [ ] Reduce memory usage. Currently nanocsv allocates some memory for intermediate buffer.
* [ ] Robust error handling.
* [ ] Robust header detection.
* [ ] Support different number of fields among records;
* [ ] Parse complex value(e.g. `3.0 + 4.2j`)
* [ ] Parse some special values, for example `#INF`, `#NAN`.
* [ ] CSV writer.

## Performance

Dataset is 4096 x 4096, 400 MB in file(generated by `tools/gencsv/gen.py`)

### Threadripper 1950X 1 thread.

```
total parsing time: 1316.13 ms
  line detection : 418.908 ms
  alloc buf      : 0.00508 ms
  parse          : 839.412 ms
  construct      : 57.7826 ms
```

### Threadripper 1950X 16 thread.

```
total parsing time: 215.303 ms
  line detection : 63.4031 ms
  alloc buf      : 0.002093 ms
  parse          : 93.8688 ms
  construct      : 57.9623 ms
```


### Threadripper 1950X 32 threads

```
total parsing time: 169.555 ms
  line detection : 38.4053 ms
  alloc buf      : 0.004228 ms
  parse          : 75.7235 ms
  construct      : 55.3194 ms
```

Roughly **7.78 times faster** than signle therad parsing.

### Note on the performance.

`construct` stage is not parallelized. We could optimize and paralellize this stage further to get better speed.


## References

* RFC 4180 https://www.ietf.org/rfc/rfc4180.txt

## License

MIT License

### Third-party license

* stack_container : Copyright (c) 2006-2008 The Chromium Authors. BSD-style license.

